import{R as pn,P as hn,E as dn,V as H,M as ut,T as ft,Q as Kt,S as de,a as V,b as mn,O as Bt,c as zt,d as gn,e as Ue,C as Qt,D as Ke,f as Jt,g as yn,h as vn,A as wn,i as En,j as Sn,W as xn,k as Mn,l as Pn,m as Tn,B as On,L as me,n as ge,G as ye,o as st,p as Cn}from"./tween.module-75e2fee5.js";import{e as Ln,o as bn,c as An}from"./index-72230d14.js";const ve={type:"change"},Yt={type:"start"},we={type:"end"},Ot=new pn,Ee=new hn,Rn=Math.cos(70*mn.DEG2RAD);class Dn extends dn{constructor(n,i){super(),this.object=n,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new H,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ut.ROTATE,MIDDLE:ut.DOLLY,RIGHT:ut.PAN},this.touches={ONE:ft.ROTATE,TWO:ft.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(a){a.addEventListener("keydown",Ht),this._domElementKeyEvents=a},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",Ht),this._domElementKeyEvents=null},this.saveState=function(){t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=function(){t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(ve),t.update(),p=o.NONE},this.update=function(){const a=new H,C=new Kt().setFromUnitVectors(n.up,new H(0,1,0)),F=C.clone().invert(),K=new H,G=new Kt,ct=new H,at=2*Math.PI;return function(fn=null){const he=t.object.position;a.copy(he).sub(t.target),a.applyQuaternion(C),d.setFromVector3(a),t.autoRotate&&p===o.NONE&&O(b(fn)),t.enableDamping?(d.theta+=S.theta*t.dampingFactor,d.phi+=S.phi*t.dampingFactor):(d.theta+=S.theta,d.phi+=S.phi);let nt=t.minAzimuthAngle,it=t.maxAzimuthAngle;isFinite(nt)&&isFinite(it)&&(nt<-Math.PI?nt+=at:nt>Math.PI&&(nt-=at),it<-Math.PI?it+=at:it>Math.PI&&(it-=at),nt<=it?d.theta=Math.max(nt,Math.min(it,d.theta)):d.theta=d.theta>(nt+it)/2?Math.max(nt,d.theta):Math.min(it,d.theta)),d.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,d.phi)),d.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(c,t.dampingFactor):t.target.add(c),t.zoomToCursor&&T||t.object.isOrthographicCamera?d.radius=X(d.radius):d.radius=X(d.radius*y),a.setFromSpherical(d),a.applyQuaternion(F),he.copy(t.target).add(a),t.object.lookAt(t.target),t.enableDamping===!0?(S.theta*=1-t.dampingFactor,S.phi*=1-t.dampingFactor,c.multiplyScalar(1-t.dampingFactor)):(S.set(0,0,0),c.set(0,0,0));let Pt=!1;if(t.zoomToCursor&&T){let gt=null;if(t.object.isPerspectiveCamera){const yt=a.length();gt=X(yt*y);const Tt=yt-gt;t.object.position.addScaledVector(w,Tt),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const yt=new H(P.x,P.y,0);yt.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/y)),t.object.updateProjectionMatrix(),Pt=!0;const Tt=new H(P.x,P.y,0);Tt.unproject(t.object),t.object.position.sub(Tt).add(yt),t.object.updateMatrixWorld(),gt=a.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;gt!==null&&(this.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(gt).add(t.object.position):(Ot.origin.copy(t.object.position),Ot.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(Ot.direction))<Rn?n.lookAt(t.target):(Ee.setFromNormalAndCoplanarPoint(t.object.up,t.target),Ot.intersectPlane(Ee,t.target))))}else t.object.isOrthographicCamera&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/y)),t.object.updateProjectionMatrix(),Pt=!0);return y=1,T=!1,Pt||K.distanceToSquared(t.object.position)>m||8*(1-G.dot(t.object.quaternion))>m||ct.distanceToSquared(t.target)>0?(t.dispatchEvent(ve),K.copy(t.object.position),G.copy(t.object.quaternion),ct.copy(t.target),Pt=!1,!0):!1}}(),this.dispose=function(){t.domElement.removeEventListener("contextmenu",fe),t.domElement.removeEventListener("pointerdown",ce),t.domElement.removeEventListener("pointercancel",mt),t.domElement.removeEventListener("wheel",ue),t.domElement.removeEventListener("pointermove",kt),t.domElement.removeEventListener("pointerup",mt),t._domElementKeyEvents!==null&&(t._domElementKeyEvents.removeEventListener("keydown",Ht),t._domElementKeyEvents=null)};const t=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let p=o.NONE;const m=1e-6,d=new de,S=new de;let y=1;const c=new H,s=new V,l=new V,u=new V,f=new V,h=new V,r=new V,x=new V,v=new V,E=new V,w=new H,P=new V;let T=!1;const M=[],L={};function b(a){return a!==null?2*Math.PI/60*t.autoRotateSpeed*a:2*Math.PI/60/60*t.autoRotateSpeed}function R(){return Math.pow(.95,t.zoomSpeed)}function O(a){S.theta-=a}function j(a){S.phi-=a}const I=function(){const a=new H;return function(F,K){a.setFromMatrixColumn(K,0),a.multiplyScalar(-F),c.add(a)}}(),N=function(){const a=new H;return function(F,K){t.screenSpacePanning===!0?a.setFromMatrixColumn(K,1):(a.setFromMatrixColumn(K,0),a.crossVectors(t.object.up,a)),a.multiplyScalar(F),c.add(a)}}(),g=function(){const a=new H;return function(F,K){const G=t.domElement;if(t.object.isPerspectiveCamera){const ct=t.object.position;a.copy(ct).sub(t.target);let at=a.length();at*=Math.tan(t.object.fov/2*Math.PI/180),I(2*F*at/G.clientHeight,t.object.matrix),N(2*K*at/G.clientHeight,t.object.matrix)}else t.object.isOrthographicCamera?(I(F*(t.object.right-t.object.left)/t.object.zoom/G.clientWidth,t.object.matrix),N(K*(t.object.top-t.object.bottom)/t.object.zoom/G.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}}();function A(a){t.object.isPerspectiveCamera||t.object.isOrthographicCamera?y/=a:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function k(a){t.object.isPerspectiveCamera||t.object.isOrthographicCamera?y*=a:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function B(a){if(!t.zoomToCursor)return;T=!0;const C=t.domElement.getBoundingClientRect(),F=a.clientX-C.left,K=a.clientY-C.top,G=C.width,ct=C.height;P.x=F/G*2-1,P.y=-(K/ct)*2+1,w.set(P.x,P.y,1).unproject(t.object).sub(t.object.position).normalize()}function X(a){return Math.max(t.minDistance,Math.min(t.maxDistance,a))}function ot(a){s.set(a.clientX,a.clientY)}function Q(a){B(a),x.set(a.clientX,a.clientY)}function tt(a){f.set(a.clientX,a.clientY)}function J(a){l.set(a.clientX,a.clientY),u.subVectors(l,s).multiplyScalar(t.rotateSpeed);const C=t.domElement;O(2*Math.PI*u.x/C.clientHeight),j(2*Math.PI*u.y/C.clientHeight),s.copy(l),t.update()}function lt(a){v.set(a.clientX,a.clientY),E.subVectors(v,x),E.y>0?A(R()):E.y<0&&k(R()),x.copy(v),t.update()}function rt(a){h.set(a.clientX,a.clientY),r.subVectors(h,f).multiplyScalar(t.panSpeed),g(r.x,r.y),f.copy(h),t.update()}function Qe(a){B(a),a.deltaY<0?k(R()):a.deltaY>0&&A(R()),t.update()}function Je(a){let C=!1;switch(a.code){case t.keys.UP:a.ctrlKey||a.metaKey||a.shiftKey?j(2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):g(0,t.keyPanSpeed),C=!0;break;case t.keys.BOTTOM:a.ctrlKey||a.metaKey||a.shiftKey?j(-2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):g(0,-t.keyPanSpeed),C=!0;break;case t.keys.LEFT:a.ctrlKey||a.metaKey||a.shiftKey?O(2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):g(t.keyPanSpeed,0),C=!0;break;case t.keys.RIGHT:a.ctrlKey||a.metaKey||a.shiftKey?O(-2*Math.PI*t.rotateSpeed/t.domElement.clientHeight):g(-t.keyPanSpeed,0),C=!0;break}C&&(a.preventDefault(),t.update())}function ie(){if(M.length===1)s.set(M[0].pageX,M[0].pageY);else{const a=.5*(M[0].pageX+M[1].pageX),C=.5*(M[0].pageY+M[1].pageY);s.set(a,C)}}function oe(){if(M.length===1)f.set(M[0].pageX,M[0].pageY);else{const a=.5*(M[0].pageX+M[1].pageX),C=.5*(M[0].pageY+M[1].pageY);f.set(a,C)}}function re(){const a=M[0].pageX-M[1].pageX,C=M[0].pageY-M[1].pageY,F=Math.sqrt(a*a+C*C);x.set(0,F)}function tn(){t.enableZoom&&re(),t.enablePan&&oe()}function en(){t.enableZoom&&re(),t.enableRotate&&ie()}function ae(a){if(M.length==1)l.set(a.pageX,a.pageY);else{const F=Wt(a),K=.5*(a.pageX+F.x),G=.5*(a.pageY+F.y);l.set(K,G)}u.subVectors(l,s).multiplyScalar(t.rotateSpeed);const C=t.domElement;O(2*Math.PI*u.x/C.clientHeight),j(2*Math.PI*u.y/C.clientHeight),s.copy(l)}function se(a){if(M.length===1)h.set(a.pageX,a.pageY);else{const C=Wt(a),F=.5*(a.pageX+C.x),K=.5*(a.pageY+C.y);h.set(F,K)}r.subVectors(h,f).multiplyScalar(t.panSpeed),g(r.x,r.y),f.copy(h)}function le(a){const C=Wt(a),F=a.pageX-C.x,K=a.pageY-C.y,G=Math.sqrt(F*F+K*K);v.set(0,G),E.set(0,Math.pow(v.y/x.y,t.zoomSpeed)),A(E.y),x.copy(v)}function nn(a){t.enableZoom&&le(a),t.enablePan&&se(a)}function on(a){t.enableZoom&&le(a),t.enableRotate&&ae(a)}function ce(a){t.enabled!==!1&&(M.length===0&&(t.domElement.setPointerCapture(a.pointerId),t.domElement.addEventListener("pointermove",kt),t.domElement.addEventListener("pointerup",mt)),cn(a),a.pointerType==="touch"?sn(a):rn(a))}function kt(a){t.enabled!==!1&&(a.pointerType==="touch"?ln(a):an(a))}function mt(a){un(a),M.length===0&&(t.domElement.releasePointerCapture(a.pointerId),t.domElement.removeEventListener("pointermove",kt),t.domElement.removeEventListener("pointerup",mt)),t.dispatchEvent(we),p=o.NONE}function rn(a){let C;switch(a.button){case 0:C=t.mouseButtons.LEFT;break;case 1:C=t.mouseButtons.MIDDLE;break;case 2:C=t.mouseButtons.RIGHT;break;default:C=-1}switch(C){case ut.DOLLY:if(t.enableZoom===!1)return;Q(a),p=o.DOLLY;break;case ut.ROTATE:if(a.ctrlKey||a.metaKey||a.shiftKey){if(t.enablePan===!1)return;tt(a),p=o.PAN}else{if(t.enableRotate===!1)return;ot(a),p=o.ROTATE}break;case ut.PAN:if(a.ctrlKey||a.metaKey||a.shiftKey){if(t.enableRotate===!1)return;ot(a),p=o.ROTATE}else{if(t.enablePan===!1)return;tt(a),p=o.PAN}break;default:p=o.NONE}p!==o.NONE&&t.dispatchEvent(Yt)}function an(a){switch(p){case o.ROTATE:if(t.enableRotate===!1)return;J(a);break;case o.DOLLY:if(t.enableZoom===!1)return;lt(a);break;case o.PAN:if(t.enablePan===!1)return;rt(a);break}}function ue(a){t.enabled===!1||t.enableZoom===!1||p!==o.NONE||(a.preventDefault(),t.dispatchEvent(Yt),Qe(a),t.dispatchEvent(we))}function Ht(a){t.enabled===!1||t.enablePan===!1||Je(a)}function sn(a){switch(pe(a),M.length){case 1:switch(t.touches.ONE){case ft.ROTATE:if(t.enableRotate===!1)return;ie(),p=o.TOUCH_ROTATE;break;case ft.PAN:if(t.enablePan===!1)return;oe(),p=o.TOUCH_PAN;break;default:p=o.NONE}break;case 2:switch(t.touches.TWO){case ft.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;tn(),p=o.TOUCH_DOLLY_PAN;break;case ft.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;en(),p=o.TOUCH_DOLLY_ROTATE;break;default:p=o.NONE}break;default:p=o.NONE}p!==o.NONE&&t.dispatchEvent(Yt)}function ln(a){switch(pe(a),p){case o.TOUCH_ROTATE:if(t.enableRotate===!1)return;ae(a),t.update();break;case o.TOUCH_PAN:if(t.enablePan===!1)return;se(a),t.update();break;case o.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;nn(a),t.update();break;case o.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;on(a),t.update();break;default:p=o.NONE}}function fe(a){t.enabled!==!1&&a.preventDefault()}function cn(a){M.push(a)}function un(a){delete L[a.pointerId];for(let C=0;C<M.length;C++)if(M[C].pointerId==a.pointerId){M.splice(C,1);return}}function pe(a){let C=L[a.pointerId];C===void 0&&(C=new V,L[a.pointerId]=C),C.set(a.pageX,a.pageY)}function Wt(a){const C=a.pointerId===M[0].pointerId?M[1]:M[0];return L[C.pointerId]}t.domElement.addEventListener("contextmenu",fe),t.domElement.addEventListener("pointerdown",ce),t.domElement.addEventListener("pointercancel",mt),t.domElement.addEventListener("wheel",ue,{passive:!1}),this.update()}}class Se extends Bt{constructor(n=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=n,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new V(.5,.5),this.addEventListener("removed",function(){this.traverse(function(i){i.element instanceof Element&&i.element.parentNode!==null&&i.element.parentNode.removeChild(i.element)})})}copy(n,i){return super.copy(n,i),this.element=n.element.cloneNode(!0),this.center=n.center,this}}const pt=new H,xe=new zt,Me=new zt,Pe=new H,Te=new H;class Nn{constructor(n={}){const i=this;let t,o,p,m;const d={objects:new WeakMap},S=n.element!==void 0?n.element:document.createElement("div");S.style.overflow="hidden",this.domElement=S,this.getSize=function(){return{width:t,height:o}},this.render=function(u,f){u.matrixWorldAutoUpdate===!0&&u.updateMatrixWorld(),f.parent===null&&f.matrixWorldAutoUpdate===!0&&f.updateMatrixWorld(),xe.copy(f.matrixWorldInverse),Me.multiplyMatrices(f.projectionMatrix,xe),y(u,u,f),l(u)},this.setSize=function(u,f){t=u,o=f,p=t/2,m=o/2,S.style.width=u+"px",S.style.height=f+"px"};function y(u,f,h){if(u.isCSS2DObject){pt.setFromMatrixPosition(u.matrixWorld),pt.applyMatrix4(Me);const r=u.visible===!0&&pt.z>=-1&&pt.z<=1&&u.layers.test(h.layers)===!0;if(u.element.style.display=r===!0?"":"none",r===!0){u.onBeforeRender(i,f,h);const v=u.element;v.style.transform="translate("+-100*u.center.x+"%,"+-100*u.center.y+"%)translate("+(pt.x*p+p)+"px,"+(-pt.y*m+m)+"px)",v.parentNode!==S&&S.appendChild(v),u.onAfterRender(i,f,h)}const x={distanceToCameraSquared:c(h,u)};d.objects.set(u,x)}for(let r=0,x=u.children.length;r<x;r++)y(u.children[r],f,h)}function c(u,f){return Pe.setFromMatrixPosition(u.matrixWorld),Te.setFromMatrixPosition(f.matrixWorld),Pe.distanceToSquared(Te)}function s(u){const f=[];return u.traverse(function(h){h.isCSS2DObject&&f.push(h)}),f}function l(u){const f=s(u).sort(function(r,x){if(r.renderOrder!==x.renderOrder)return x.renderOrder-r.renderOrder;const v=d.objects.get(r).distanceToCameraSquared,E=d.objects.get(x).distanceToCameraSquared;return v-E}),h=f.length;for(let r=0,x=f.length;r<x;r++)f[r].element.style.zIndex=h-r}}}const Oe=new H,In=new Kt,Ce=new H,et=new zt,_n=new zt;class zn{constructor(n={}){const i=this;let t,o,p,m;const d={camera:{fov:0,style:""},objects:new WeakMap},S=n.element!==void 0?n.element:document.createElement("div");S.style.overflow="hidden",this.domElement=S;const y=document.createElement("div");y.style.transformOrigin="0 0",y.style.pointerEvents="none",S.appendChild(y);const c=document.createElement("div");c.style.transformStyle="preserve-3d",y.appendChild(c),this.getSize=function(){return{width:t,height:o}},this.render=function(h,r){const x=r.projectionMatrix.elements[5]*m;d.camera.fov!==x&&(y.style.perspective=r.isPerspectiveCamera?x+"px":"",d.camera.fov=x),r.view&&r.view.enabled?(y.style.transform=`translate( ${-r.view.offsetX*(t/r.view.width)}px, ${-r.view.offsetY*(o/r.view.height)}px )`,y.style.transform+=`scale( ${r.view.fullWidth/r.view.width}, ${r.view.fullHeight/r.view.height} )`):y.style.transform="",h.matrixWorldAutoUpdate===!0&&h.updateMatrixWorld(),r.parent===null&&r.matrixWorldAutoUpdate===!0&&r.updateMatrixWorld();let v,E;r.isOrthographicCamera&&(v=-(r.right+r.left)/2,E=(r.top+r.bottom)/2);const w=r.view&&r.view.enabled?r.view.height/r.view.fullHeight:1,T=(r.isOrthographicCamera?`scale( ${w} )scale(`+x+")translate("+s(v)+"px,"+s(E)+"px)"+l(r.matrixWorldInverse):`scale( ${w} )translateZ(`+x+"px)"+l(r.matrixWorldInverse))+"translate("+p+"px,"+m+"px)";d.camera.style!==T&&(c.style.transform=T,d.camera.style=T),f(h,h,r)},this.setSize=function(h,r){t=h,o=r,p=t/2,m=o/2,S.style.width=h+"px",S.style.height=r+"px",y.style.width=h+"px",y.style.height=r+"px",c.style.width=h+"px",c.style.height=r+"px"};function s(h){return Math.abs(h)<1e-10?0:h}function l(h){const r=h.elements;return"matrix3d("+s(r[0])+","+s(-r[1])+","+s(r[2])+","+s(r[3])+","+s(r[4])+","+s(-r[5])+","+s(r[6])+","+s(r[7])+","+s(r[8])+","+s(-r[9])+","+s(r[10])+","+s(r[11])+","+s(r[12])+","+s(-r[13])+","+s(r[14])+","+s(r[15])+")"}function u(h){const r=h.elements;return"translate(-50%,-50%)"+("matrix3d("+s(r[0])+","+s(r[1])+","+s(r[2])+","+s(r[3])+","+s(-r[4])+","+s(-r[5])+","+s(-r[6])+","+s(-r[7])+","+s(r[8])+","+s(r[9])+","+s(r[10])+","+s(r[11])+","+s(r[12])+","+s(r[13])+","+s(r[14])+","+s(r[15])+")")}function f(h,r,x,v){if(h.isCSS3DObject){const E=h.visible===!0&&h.layers.test(x.layers)===!0;if(h.element.style.display=E===!0?"":"none",E===!0){h.onBeforeRender(i,r,x);let w;h.isCSS3DSprite?(et.copy(x.matrixWorldInverse),et.transpose(),h.rotation2D!==0&&et.multiply(_n.makeRotationZ(h.rotation2D)),h.matrixWorld.decompose(Oe,In,Ce),et.setPosition(Oe),et.scale(Ce),et.elements[3]=0,et.elements[7]=0,et.elements[11]=0,et.elements[15]=1,w=u(et)):w=u(h.matrixWorld);const P=h.element,T=d.objects.get(h);if(T===void 0||T.style!==w){P.style.transform=w;const M={style:w};d.objects.set(h,M)}P.parentNode!==c&&c.appendChild(P),h.onAfterRender(i,r,x)}}for(let E=0,w=h.children.length;E<w;E++)f(h.children[E],r,x)}}}class jn{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const i=this._partials;let t=0;for(let o=0;o<this._n&&o<32;o++){const p=i[o],m=n+p,d=Math.abs(n)<Math.abs(p)?n-(m-p):p-(m-n);d&&(i[t++]=d),n=m}return i[t]=n,this._n=t+1,this}valueOf(){const n=this._partials;let i=this._n,t,o,p,m=0;if(i>0){for(m=n[--i];i>0&&(t=m,o=n[--i],m=t+o,p=o-(m-t),!p););i>0&&(p<0&&n[i-1]<0||p>0&&n[i-1]>0)&&(o=p*2,t=m+o,o==t-m&&(m=t))}return m}}function*kn(e){for(const n of e)yield*n}function Be(e){return Array.from(kn(e))}var _=1e-6,Hn=1e-12,D=Math.PI,Z=D/2,Le=D/4,$=D*2,q=180/D,U=D/180,z=Math.abs,Xe=Math.atan,St=Math.atan2,W=Math.cos,Wn=Math.exp,Yn=Math.log,Y=Math.sin,Fn=Math.sign||function(e){return e>0?1:e<0?-1:0},jt=Math.sqrt,Un=Math.tan;function Kn(e){return e>1?0:e<-1?D:Math.acos(e)}function xt(e){return e>1?Z:e<-1?-Z:Math.asin(e)}function vt(){}function Dt(e,n){e&&Ae.hasOwnProperty(e.type)&&Ae[e.type](e,n)}var be={Feature:function(e,n){Dt(e.geometry,n)},FeatureCollection:function(e,n){for(var i=e.features,t=-1,o=i.length;++t<o;)Dt(i[t].geometry,n)}},Ae={Sphere:function(e,n){n.sphere()},Point:function(e,n){e=e.coordinates,n.point(e[0],e[1],e[2])},MultiPoint:function(e,n){for(var i=e.coordinates,t=-1,o=i.length;++t<o;)e=i[t],n.point(e[0],e[1],e[2])},LineString:function(e,n){Xt(e.coordinates,n,0)},MultiLineString:function(e,n){for(var i=e.coordinates,t=-1,o=i.length;++t<o;)Xt(i[t],n,0)},Polygon:function(e,n){Re(e.coordinates,n)},MultiPolygon:function(e,n){for(var i=e.coordinates,t=-1,o=i.length;++t<o;)Re(i[t],n)},GeometryCollection:function(e,n){for(var i=e.geometries,t=-1,o=i.length;++t<o;)Dt(i[t],n)}};function Xt(e,n,i){var t=-1,o=e.length-i,p;for(n.lineStart();++t<o;)p=e[t],n.point(p[0],p[1],p[2]);n.lineEnd()}function Re(e,n){var i=-1,t=e.length;for(n.polygonStart();++i<t;)Xt(e[i],n,1);n.polygonEnd()}function Bn(e,n){e&&be.hasOwnProperty(e.type)?be[e.type](e,n):Dt(e,n)}function Zt(e){return[St(e[1],e[0]),xt(e[2])]}function ht(e){var n=e[0],i=e[1],t=W(i);return[t*W(n),t*Y(n),Y(i)]}function Ct(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function Nt(e,n){return[e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0]]}function Ft(e,n){e[0]+=n[0],e[1]+=n[1],e[2]+=n[2]}function Lt(e,n){return[e[0]*n,e[1]*n,e[2]*n]}function Gt(e){var n=jt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=n,e[1]/=n,e[2]/=n}function qt(e,n){function i(t,o){return t=e(t,o),n(t[0],t[1])}return e.invert&&n.invert&&(i.invert=function(t,o){return t=n.invert(t,o),t&&e.invert(t[0],t[1])}),i}function Vt(e,n){return z(e)>D&&(e-=Math.round(e/$)*$),[e,n]}Vt.invert=Vt;function Ze(e,n,i){return(e%=$)?n||i?qt(Ne(e),Ie(n,i)):Ne(e):n||i?Ie(n,i):Vt}function De(e){return function(n,i){return n+=e,z(n)>D&&(n-=Math.round(n/$)*$),[n,i]}}function Ne(e){var n=De(e);return n.invert=De(-e),n}function Ie(e,n){var i=W(e),t=Y(e),o=W(n),p=Y(n);function m(d,S){var y=W(S),c=W(d)*y,s=Y(d)*y,l=Y(S),u=l*i+c*t;return[St(s*o-u*p,c*i-l*t),xt(u*o+s*p)]}return m.invert=function(d,S){var y=W(S),c=W(d)*y,s=Y(d)*y,l=Y(S),u=l*o-s*p;return[St(s*o+l*p,c*i+u*t),xt(u*i-c*t)]},m}function Xn(e){e=Ze(e[0]*U,e[1]*U,e.length>2?e[2]*U:0);function n(i){return i=e(i[0]*U,i[1]*U),i[0]*=q,i[1]*=q,i}return n.invert=function(i){return i=e.invert(i[0]*U,i[1]*U),i[0]*=q,i[1]*=q,i},n}function Zn(e,n,i,t,o,p){if(i){var m=W(n),d=Y(n),S=t*i;o==null?(o=n+t*$,p=n-S/2):(o=_e(m,o),p=_e(m,p),(t>0?o<p:o>p)&&(o+=t*$));for(var y,c=o;t>0?c>p:c<p;c-=S)y=Zt([m,-d*W(c),-d*Y(c)]),e.point(y[0],y[1])}}function _e(e,n){n=ht(n),n[0]-=e,Gt(n);var i=Kn(-n[1]);return((-n[2]<0?-i:i)+$-_)%$}function Ge(){var e=[],n;return{point:function(i,t,o){n.push([i,t,o])},lineStart:function(){e.push(n=[])},lineEnd:vt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],n=null,i}}}function Rt(e,n){return z(e[0]-n[0])<_&&z(e[1]-n[1])<_}function bt(e,n,i,t){this.x=e,this.z=n,this.o=i,this.e=t,this.v=!1,this.n=this.p=null}function qe(e,n,i,t,o){var p=[],m=[],d,S;if(e.forEach(function(f){if(!((h=f.length-1)<=0)){var h,r=f[0],x=f[h],v;if(Rt(r,x)){if(!r[2]&&!x[2]){for(o.lineStart(),d=0;d<h;++d)o.point((r=f[d])[0],r[1]);o.lineEnd();return}x[0]+=2*_}p.push(v=new bt(r,f,null,!0)),m.push(v.o=new bt(r,null,v,!1)),p.push(v=new bt(x,f,null,!1)),m.push(v.o=new bt(x,null,v,!0))}}),!!p.length){for(m.sort(n),ze(p),ze(m),d=0,S=m.length;d<S;++d)m[d].e=i=!i;for(var y=p[0],c,s;;){for(var l=y,u=!0;l.v;)if((l=l.n)===y)return;c=l.z,o.lineStart();do{if(l.v=l.o.v=!0,l.e){if(u)for(d=0,S=c.length;d<S;++d)o.point((s=c[d])[0],s[1]);else t(l.x,l.n.x,1,o);l=l.n}else{if(u)for(c=l.p.z,d=c.length-1;d>=0;--d)o.point((s=c[d])[0],s[1]);else t(l.x,l.p.x,-1,o);l=l.p}l=l.o,c=l.z,u=!u}while(!l.v);o.lineEnd()}}}function ze(e){if(n=e.length){for(var n,i=0,t=e[0],o;++i<n;)t.n=o=e[i],o.p=t,t=o;t.n=o=e[0],o.p=t}}function Ut(e){return z(e[0])<=D?e[0]:Fn(e[0])*((z(e[0])+D)%$-D)}function Gn(e,n){var i=Ut(n),t=n[1],o=Y(t),p=[Y(i),-W(i),0],m=0,d=0,S=new jn;o===1?t=Z+_:o===-1&&(t=-Z-_);for(var y=0,c=e.length;y<c;++y)if(l=(s=e[y]).length)for(var s,l,u=s[l-1],f=Ut(u),h=u[1]/2+Le,r=Y(h),x=W(h),v=0;v<l;++v,f=w,r=T,x=M,u=E){var E=s[v],w=Ut(E),P=E[1]/2+Le,T=Y(P),M=W(P),L=w-f,b=L>=0?1:-1,R=b*L,O=R>D,j=r*T;if(S.add(St(j*b*Y(R),x*M+j*W(R))),m+=O?L+b*$:L,O^f>=i^w>=i){var I=Nt(ht(u),ht(E));Gt(I);var N=Nt(p,I);Gt(N);var g=(O^L>=0?-1:1)*xt(N[2]);(t>g||t===g&&(I[0]||I[1]))&&(d+=O^L>=0?1:-1)}}return(m<-_||m<_&&S<-Hn)^d&1}function Ve(e,n,i,t){return function(o){var p=n(o),m=Ge(),d=n(m),S=!1,y,c,s,l={point:u,lineStart:h,lineEnd:r,polygonStart:function(){l.point=x,l.lineStart=v,l.lineEnd=E,c=[],y=[]},polygonEnd:function(){l.point=u,l.lineStart=h,l.lineEnd=r,c=Be(c);var w=Gn(y,t);c.length?(S||(o.polygonStart(),S=!0),qe(c,Vn,w,i,o)):w&&(S||(o.polygonStart(),S=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),S&&(o.polygonEnd(),S=!1),c=y=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function u(w,P){e(w,P)&&o.point(w,P)}function f(w,P){p.point(w,P)}function h(){l.point=f,p.lineStart()}function r(){l.point=u,p.lineEnd()}function x(w,P){s.push([w,P]),d.point(w,P)}function v(){d.lineStart(),s=[]}function E(){x(s[0][0],s[0][1]),d.lineEnd();var w=d.clean(),P=m.result(),T,M=P.length,L,b,R;if(s.pop(),y.push(s),s=null,!!M){if(w&1){if(b=P[0],(L=b.length-1)>0){for(S||(o.polygonStart(),S=!0),o.lineStart(),T=0;T<L;++T)o.point((R=b[T])[0],R[1]);o.lineEnd()}return}M>1&&w&2&&P.push(P.pop().concat(P.shift())),c.push(P.filter(qn))}}return l}}function qn(e){return e.length>1}function Vn(e,n){return((e=e.x)[0]<0?e[1]-Z-_:Z-e[1])-((n=n.x)[0]<0?n[1]-Z-_:Z-n[1])}const je=Ve(function(){return!0},$n,Jn,[-D,-Z]);function $n(e){var n=NaN,i=NaN,t=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(p,m){var d=p>0?D:-D,S=z(p-n);z(S-D)<_?(e.point(n,i=(i+m)/2>0?Z:-Z),e.point(t,i),e.lineEnd(),e.lineStart(),e.point(d,i),e.point(p,i),o=0):t!==d&&S>=D&&(z(n-t)<_&&(n-=t*_),z(p-d)<_&&(p-=d*_),i=Qn(n,i,p,m),e.point(t,i),e.lineEnd(),e.lineStart(),e.point(d,i),o=0),e.point(n=p,i=m),t=d},lineEnd:function(){e.lineEnd(),n=i=NaN},clean:function(){return 2-o}}}function Qn(e,n,i,t){var o,p,m=Y(e-i);return z(m)>_?Xe((Y(n)*(p=W(t))*Y(i)-Y(t)*(o=W(n))*Y(e))/(o*p*m)):(n+t)/2}function Jn(e,n,i,t){var o;if(e==null)o=i*Z,t.point(-D,o),t.point(0,o),t.point(D,o),t.point(D,0),t.point(D,-o),t.point(0,-o),t.point(-D,-o),t.point(-D,0),t.point(-D,o);else if(z(e[0]-n[0])>_){var p=e[0]<n[0]?D:-D;o=i*p/2,t.point(-p,o),t.point(0,o),t.point(p,o)}else t.point(n[0],n[1])}function ti(e){var n=W(e),i=6*U,t=n>0,o=z(n)>_;function p(c,s,l,u){Zn(u,e,i,l,c,s)}function m(c,s){return W(c)*W(s)>n}function d(c){var s,l,u,f,h;return{lineStart:function(){f=u=!1,h=1},point:function(r,x){var v=[r,x],E,w=m(r,x),P=t?w?0:y(r,x):w?y(r+(r<0?D:-D),x):0;if(!s&&(f=u=w)&&c.lineStart(),w!==u&&(E=S(s,v),(!E||Rt(s,E)||Rt(v,E))&&(v[2]=1)),w!==u)h=0,w?(c.lineStart(),E=S(v,s),c.point(E[0],E[1])):(E=S(s,v),c.point(E[0],E[1],2),c.lineEnd()),s=E;else if(o&&s&&t^w){var T;!(P&l)&&(T=S(v,s,!0))&&(h=0,t?(c.lineStart(),c.point(T[0][0],T[0][1]),c.point(T[1][0],T[1][1]),c.lineEnd()):(c.point(T[1][0],T[1][1]),c.lineEnd(),c.lineStart(),c.point(T[0][0],T[0][1],3)))}w&&(!s||!Rt(s,v))&&c.point(v[0],v[1]),s=v,u=w,l=P},lineEnd:function(){u&&c.lineEnd(),s=null},clean:function(){return h|(f&&u)<<1}}}function S(c,s,l){var u=ht(c),f=ht(s),h=[1,0,0],r=Nt(u,f),x=Ct(r,r),v=r[0],E=x-v*v;if(!E)return!l&&c;var w=n*x/E,P=-n*v/E,T=Nt(h,r),M=Lt(h,w),L=Lt(r,P);Ft(M,L);var b=T,R=Ct(M,b),O=Ct(b,b),j=R*R-O*(Ct(M,M)-1);if(!(j<0)){var I=jt(j),N=Lt(b,(-R-I)/O);if(Ft(N,M),N=Zt(N),!l)return N;var g=c[0],A=s[0],k=c[1],B=s[1],X;A<g&&(X=g,g=A,A=X);var ot=A-g,Q=z(ot-D)<_,tt=Q||ot<_;if(!Q&&B<k&&(X=k,k=B,B=X),tt?Q?k+B>0^N[1]<(z(N[0]-g)<_?k:B):k<=N[1]&&N[1]<=B:ot>D^(g<=N[0]&&N[0]<=A)){var J=Lt(b,(-R+I)/O);return Ft(J,M),[N,Zt(J)]}}}function y(c,s){var l=t?e:D-e,u=0;return c<-l?u|=1:c>l&&(u|=2),s<-l?u|=4:s>l&&(u|=8),u}return Ve(m,d,p,t?[0,-e]:[-D,e-D])}function ei(e,n,i,t,o,p){var m=e[0],d=e[1],S=n[0],y=n[1],c=0,s=1,l=S-m,u=y-d,f;if(f=i-m,!(!l&&f>0)){if(f/=l,l<0){if(f<c)return;f<s&&(s=f)}else if(l>0){if(f>s)return;f>c&&(c=f)}if(f=o-m,!(!l&&f<0)){if(f/=l,l<0){if(f>s)return;f>c&&(c=f)}else if(l>0){if(f<c)return;f<s&&(s=f)}if(f=t-d,!(!u&&f>0)){if(f/=u,u<0){if(f<c)return;f<s&&(s=f)}else if(u>0){if(f>s)return;f>c&&(c=f)}if(f=p-d,!(!u&&f<0)){if(f/=u,u<0){if(f>s)return;f>c&&(c=f)}else if(u>0){if(f<c)return;f<s&&(s=f)}return c>0&&(e[0]=m+c*l,e[1]=d+c*u),s<1&&(n[0]=m+s*l,n[1]=d+s*u),!0}}}}}var wt=1e9,At=-wt;function ni(e,n,i,t){function o(y,c){return e<=y&&y<=i&&n<=c&&c<=t}function p(y,c,s,l){var u=0,f=0;if(y==null||(u=m(y,s))!==(f=m(c,s))||S(y,c)<0^s>0)do l.point(u===0||u===3?e:i,u>1?t:n);while((u=(u+s+4)%4)!==f);else l.point(c[0],c[1])}function m(y,c){return z(y[0]-e)<_?c>0?0:3:z(y[0]-i)<_?c>0?2:1:z(y[1]-n)<_?c>0?1:0:c>0?3:2}function d(y,c){return S(y.x,c.x)}function S(y,c){var s=m(y,1),l=m(c,1);return s!==l?s-l:s===0?c[1]-y[1]:s===1?y[0]-c[0]:s===2?y[1]-c[1]:c[0]-y[0]}return function(y){var c=y,s=Ge(),l,u,f,h,r,x,v,E,w,P,T,M={point:L,lineStart:j,lineEnd:I,polygonStart:R,polygonEnd:O};function L(g,A){o(g,A)&&c.point(g,A)}function b(){for(var g=0,A=0,k=u.length;A<k;++A)for(var B=u[A],X=1,ot=B.length,Q=B[0],tt,J,lt=Q[0],rt=Q[1];X<ot;++X)tt=lt,J=rt,Q=B[X],lt=Q[0],rt=Q[1],J<=t?rt>t&&(lt-tt)*(t-J)>(rt-J)*(e-tt)&&++g:rt<=t&&(lt-tt)*(t-J)<(rt-J)*(e-tt)&&--g;return g}function R(){c=s,l=[],u=[],T=!0}function O(){var g=b(),A=T&&g,k=(l=Be(l)).length;(A||k)&&(y.polygonStart(),A&&(y.lineStart(),p(null,null,1,y),y.lineEnd()),k&&qe(l,d,g,p,y),y.polygonEnd()),c=y,l=u=f=null}function j(){M.point=N,u&&u.push(f=[]),P=!0,w=!1,v=E=NaN}function I(){l&&(N(h,r),x&&w&&s.rejoin(),l.push(s.result())),M.point=L,w&&c.lineEnd()}function N(g,A){var k=o(g,A);if(u&&f.push([g,A]),P)h=g,r=A,x=k,P=!1,k&&(c.lineStart(),c.point(g,A));else if(k&&w)c.point(g,A);else{var B=[v=Math.max(At,Math.min(wt,v)),E=Math.max(At,Math.min(wt,E))],X=[g=Math.max(At,Math.min(wt,g)),A=Math.max(At,Math.min(wt,A))];ei(B,X,e,n,i,t)?(w||(c.lineStart(),c.point(B[0],B[1])),c.point(X[0],X[1]),k||c.lineEnd(),T=!1):k&&(c.lineStart(),c.point(g,A),T=!1)}v=g,E=A,w=k}return M}}const ke=e=>e;var dt=1/0,It=dt,Mt=-dt,_t=Mt,ii={point:oi,lineStart:vt,lineEnd:vt,polygonStart:vt,polygonEnd:vt,result:function(){var e=[[dt,It],[Mt,_t]];return Mt=_t=-(It=dt=1/0),e}};function oi(e,n){e<dt&&(dt=e),e>Mt&&(Mt=e),n<It&&(It=n),n>_t&&(_t=n)}const He=ii;function te(e){return function(n){var i=new $t;for(var t in e)i[t]=e[t];return i.stream=n,i}}function $t(){}$t.prototype={constructor:$t,point:function(e,n){this.stream.point(e,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ee(e,n,i){var t=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),t!=null&&e.clipExtent(null),Bn(i,e.stream(He)),n(He.result()),t!=null&&e.clipExtent(t),e}function $e(e,n,i){return ee(e,function(t){var o=n[1][0]-n[0][0],p=n[1][1]-n[0][1],m=Math.min(o/(t[1][0]-t[0][0]),p/(t[1][1]-t[0][1])),d=+n[0][0]+(o-m*(t[1][0]+t[0][0]))/2,S=+n[0][1]+(p-m*(t[1][1]+t[0][1]))/2;e.scale(150*m).translate([d,S])},i)}function ri(e,n,i){return $e(e,[[0,0],n],i)}function ai(e,n,i){return ee(e,function(t){var o=+n,p=o/(t[1][0]-t[0][0]),m=(o-p*(t[1][0]+t[0][0]))/2,d=-p*t[0][1];e.scale(150*p).translate([m,d])},i)}function si(e,n,i){return ee(e,function(t){var o=+n,p=o/(t[1][1]-t[0][1]),m=-p*t[0][0],d=(o-p*(t[1][1]+t[0][1]))/2;e.scale(150*p).translate([m,d])},i)}var We=16,li=W(30*U);function Ye(e,n){return+n?ui(e,n):ci(e)}function ci(e){return te({point:function(n,i){n=e(n,i),this.stream.point(n[0],n[1])}})}function ui(e,n){function i(t,o,p,m,d,S,y,c,s,l,u,f,h,r){var x=y-t,v=c-o,E=x*x+v*v;if(E>4*n&&h--){var w=m+l,P=d+u,T=S+f,M=jt(w*w+P*P+T*T),L=xt(T/=M),b=z(z(T)-1)<_||z(p-s)<_?(p+s)/2:St(P,w),R=e(b,L),O=R[0],j=R[1],I=O-t,N=j-o,g=v*I-x*N;(g*g/E>n||z((x*I+v*N)/E-.5)>.3||m*l+d*u+S*f<li)&&(i(t,o,p,m,d,S,O,j,b,w/=M,P/=M,T,h,r),r.point(O,j),i(O,j,b,w,P,T,y,c,s,l,u,f,h,r))}}return function(t){var o,p,m,d,S,y,c,s,l,u,f,h,r={point:x,lineStart:v,lineEnd:w,polygonStart:function(){t.polygonStart(),r.lineStart=P},polygonEnd:function(){t.polygonEnd(),r.lineStart=v}};function x(L,b){L=e(L,b),t.point(L[0],L[1])}function v(){s=NaN,r.point=E,t.lineStart()}function E(L,b){var R=ht([L,b]),O=e(L,b);i(s,l,c,u,f,h,s=O[0],l=O[1],c=L,u=R[0],f=R[1],h=R[2],We,t),t.point(s,l)}function w(){r.point=x,t.lineEnd()}function P(){v(),r.point=T,r.lineEnd=M}function T(L,b){E(o=L,b),p=s,m=l,d=u,S=f,y=h,r.point=E}function M(){i(s,l,c,u,f,h,p,m,o,d,S,y,We,t),r.lineEnd=w,w()}return r}}var fi=te({point:function(e,n){this.stream.point(e*U,n*U)}});function pi(e){return te({point:function(n,i){var t=e(n,i);return this.stream.point(t[0],t[1])}})}function hi(e,n,i,t,o){function p(m,d){return m*=t,d*=o,[n+e*m,i-e*d]}return p.invert=function(m,d){return[(m-n)/e*t,(i-d)/e*o]},p}function Fe(e,n,i,t,o,p){if(!p)return hi(e,n,i,t,o);var m=W(p),d=Y(p),S=m*e,y=d*e,c=m/e,s=d/e,l=(d*i-m*n)/e,u=(d*n+m*i)/e;function f(h,r){return h*=t,r*=o,[S*h-y*r+n,i-y*h-S*r]}return f.invert=function(h,r){return[t*(c*h-s*r+l),o*(u-s*h-c*r)]},f}function di(e){return mi(function(){return e})()}function mi(e){var n,i=150,t=480,o=250,p=0,m=0,d=0,S=0,y=0,c,s=0,l=1,u=1,f=null,h=je,r=null,x,v,E,w=ke,P=.5,T,M,L,b,R;function O(g){return L(g[0]*U,g[1]*U)}function j(g){return g=L.invert(g[0],g[1]),g&&[g[0]*q,g[1]*q]}O.stream=function(g){return b&&R===g?b:b=fi(pi(c)(h(T(w(R=g)))))},O.preclip=function(g){return arguments.length?(h=g,f=void 0,N()):h},O.postclip=function(g){return arguments.length?(w=g,r=x=v=E=null,N()):w},O.clipAngle=function(g){return arguments.length?(h=+g?ti(f=g*U):(f=null,je),N()):f*q},O.clipExtent=function(g){return arguments.length?(w=g==null?(r=x=v=E=null,ke):ni(r=+g[0][0],x=+g[0][1],v=+g[1][0],E=+g[1][1]),N()):r==null?null:[[r,x],[v,E]]},O.scale=function(g){return arguments.length?(i=+g,I()):i},O.translate=function(g){return arguments.length?(t=+g[0],o=+g[1],I()):[t,o]},O.center=function(g){return arguments.length?(p=g[0]%360*U,m=g[1]%360*U,I()):[p*q,m*q]},O.rotate=function(g){return arguments.length?(d=g[0]%360*U,S=g[1]%360*U,y=g.length>2?g[2]%360*U:0,I()):[d*q,S*q,y*q]},O.angle=function(g){return arguments.length?(s=g%360*U,I()):s*q},O.reflectX=function(g){return arguments.length?(l=g?-1:1,I()):l<0},O.reflectY=function(g){return arguments.length?(u=g?-1:1,I()):u<0},O.precision=function(g){return arguments.length?(T=Ye(M,P=g*g),N()):jt(P)},O.fitExtent=function(g,A){return $e(O,g,A)},O.fitSize=function(g,A){return ri(O,g,A)},O.fitWidth=function(g,A){return ai(O,g,A)},O.fitHeight=function(g,A){return si(O,g,A)};function I(){var g=Fe(i,0,0,l,u,s).apply(null,n(p,m)),A=Fe(i,t-g[0],o-g[1],l,u,s);return c=Ze(d,S,y),M=qt(n,A),L=qt(c,M),T=Ye(M,P),N()}function N(){return b=R=null,O}return function(){return n=e.apply(this,arguments),O.invert=n.invert&&j,I()}}function ne(e,n){return[e,Yn(Un((Z+n)/2))]}ne.invert=function(e,n){return[e,2*Xe(Wn(n))-Z]};function gi(){return yi(ne).scale(961/$)}function yi(e){var n=di(e),i=n.center,t=n.scale,o=n.translate,p=n.clipExtent,m=null,d,S,y;n.scale=function(s){return arguments.length?(t(s),c()):t()},n.translate=function(s){return arguments.length?(o(s),c()):o()},n.center=function(s){return arguments.length?(i(s),c()):i()},n.clipExtent=function(s){return arguments.length?(s==null?m=d=S=y=null:(m=+s[0][0],d=+s[0][1],S=+s[1][0],y=+s[1][1]),c()):m==null?null:[[m,d],[S,y]]};function c(){var s=D*t(),l=n(Xn(n.rotate()).invert([0,0]));return p(m==null?[[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]]:e===ne?[[Math.max(l[0]-s,m),d],[Math.min(l[0]+s,S),y]]:[[m,Math.max(l[1]-s,d)],[S,Math.min(l[1]+s,y)]])}return c()}function Et(e,n,i){this.k=e,this.x=n,this.y=i}Et.prototype={constructor:Et,scale:function(e){return e===1?this:new Et(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new Et(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Et.prototype;function vi(){const n="#8ECBFF",i=new gn(1,1,1,1),t=`  
    varying vec2 vUv;
    void main() { 
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }`,o=`
    varying vec2 vUv;
    uniform vec3 uColor;
    uniform float uOpacity;
    uniform float uSpeed; 
    uniform float uSge;
    uniform float time;
    float PI = 3.14159265;
    float drawCircle(float index, float range) {
        float opacity = 1.0;
        if (index >= 1.0 - range) {
            opacity = 1.0 - (index - (1.0 - range)) / range;
        } else if(index <= range) {
            opacity = index / range;
        } 
        return opacity;
    }
    float distanceTo(vec2 src, vec2 dst) {
        float dx = src.x - dst.x;
        float dy = src.y - dst.y;
        float dv = dx * dx + dy * dy;
        return sqrt(dv);
    } 
    void main() { 
        float iTime = -time * uSpeed;
        float opacity = 0.0;
        float len = distanceTo(vec2(0.5, 0.5), vec2(vUv.x, vUv.y)); 

        float size = 1.0 / uSge;
        vec2 range = vec2(0.7 - size, 0.7 + size);
        float index = mod(iTime + len, size); 
        // 中心圆 
        vec2 cRadius = vec2(0.06, 0.12); 
        
        if (index < size && len <= 0.5) {   
            float i = sin(index / size * PI); 

            // 处理边缘锯齿
            if (i >= range.x && i <= range.y){
                // 归一
                float t = (i - range.x) / (range.y - range.x);
                // 边缘锯齿范围
                float r = 0.3;
                opacity = drawCircle(t, r);
                
            }
            // 渐变
            opacity *=  1.0 - len / 0.5;
        }; 
        
        gl_FragColor = vec4(uColor, uOpacity * opacity);
    }`,p=new Ue({uniforms:{uColor:{value:new Qt(n)},uOpacity:{value:1},uSpeed:{value:.2},uSge:{value:2},uRadius:{value:1/2},time:{value:0}},transparent:!0,vertexShader:t,fragmentShader:o,alphaTest:.5,side:Ke,depthWrite:!1});return new Jt(i,p)}function wi(){let n=new Qt(9358335);const i=new Ue({vertexShader:`
            varying vec3 modelPos;
            void main() {
                modelPos = position;
                // 顶点位置计算，这里简化为直接输出
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `,fragmentShader:`
            uniform vec3 lightColor;
            uniform float intensity;
            uniform float height;
            varying vec3 modelPos;

            void main() {
                // 计算光线效果
                gl_FragColor = vec4(lightColor, 1);
            }
        `,uniforms:{lightColor:{value:new H(n.r,n.g,n.b)},intensity:{value:1},height:{value:.5}}}),t=new yn(.1,.01,.5,10,10,!1);return new Jt(t,i)}function Ei(){const e=["A","B","C","M","E","U"],n=e[Math.floor(Math.random()*e.length)],i=["","D","F"],t=i[Math.floor(Math.random()*i.length)];for(var o="ABCDEFGHJKLMNPQRSTUVWXYZ1234567890",p="",m=0;m<5;m++)p+=o.charAt(Math.floor(Math.random()*o.length));var d="苏"+n+t+p;return d}const Si={id:"map"},Ti={__name:"index",setup(e){Ln(()=>{const l=new vn,u=new wn(13953021,4);l.add(u);const f=new En(15264491,.2);f.position.set(0,10,5);const h=f.clone();h.position.set(0,10,-5);const r=f.clone();r.position.set(5,10,0);const x=f.clone();x.position.set(-5,10,0),l.add(f),l.add(h),l.add(r),l.add(x);const v=new Sn(75,window.innerWidth/window.innerHeight,.1,1e3);v.position.y=3,v.position.z=3;const E=new Nn;E.domElement.style.position="absolute",E.domElement.style.top="0px",E.domElement.style.pointerEvents="none",E.setSize(window.innerWidth,window.innerHeight),document.getElementById("map").appendChild(E.domElement);const w=new zn;w.domElement.style.position="absolute",w.domElement.style.top="0px",w.domElement.style.pointerEvents="none",w.setSize(window.innerWidth,window.innerHeight),document.getElementById("map").appendChild(w.domElement);const P=new xn({antialias:!0});P.setSize(window.innerWidth,window.innerHeight),P.setPixelRatio(window.devicePixelRatio),P.autoClear=!1,document.getElementById("map").appendChild(P.domElement);const T=new Dn(v,P.domElement);T.update();const M=()=>{requestAnimationFrame(M),T.update(),P.render(l,v),E.render(l,v),w.render(l,v),d.children.forEach(b=>{b.material.uniforms.time.value+=.02}),st.update()};M(),window.addEventListener("resize",()=>{v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix(),P.setSize(window.innerWidth,window.innerHeight),E.setSize(window.innerWidth,window.innerHeight)}),fetch("/wj.json").then(b=>b.json()).then(b=>{const R=t(b);l.add(R),y(R),window.addEventListener("pointerdown",O=>{})})});const n=gi().scale(500),i=new Bt,t=l=>{const u=l.features[0].properties.centroid;return n.center(u).translate([0,0]),l.features.forEach(f=>{const h=new Bt,{centroid:r,center:x,name:v}=f.properties,{coordinates:E,type:w}=f.geometry,P=r||x||[0,0],T=new Qt(`hsl(
        233,
        ${Math.random()*30+55}%,
        ${Math.random()*30+55}%)`).getHex(),M=.2,L=m(v,P,M);E.forEach(b=>{w==="MultiPolygon"&&b.forEach(O=>R(O)),w==="Polygon"&&R(b);function R(O){h.name=v;const j=o(O,T,M),I=p(O,M);h.add(j,...I)}}),i.add(h,L),s(i)}),i},o=(l,u,f)=>{const h=new Mn;l.forEach((P,T)=>{const[M,L]=n(P);T===0?h.moveTo(M,-L):h.lineTo(M,-L)});const r={depth:f,bevelEnabled:!1},x={color:u,emissive:0,roughness:.45,metalness:.8,transparent:!0,side:Ke},v=new Pn(h,r),E=new Tn(x);return new Jt(v,E)},p=(l,u)=>{const f=[];l.forEach(w=>{const[P,T]=n(w);f.push(new H(P,-T,0))});const h=new On().setFromPoints(f),r=new me({color:16777215}),x=new me({color:16777215}),v=new ge(h,r),E=new ge(h,x);return E.position.z=-1e-4,v.position.z=u+1e-4,[v,E]},m=(l,u,f)=>{const h=document.createElement("div");h.style.color="#fff",h.style.fontSize="12px",h.style.textShadow="1px 1px 2px #047cd6",h.textContent=l;const r=new Se(h);r.scale.set(.01,.01,.01);const[x,v]=n(u);return r.position.set(x,-v,f),r},d=new ye,S=new ye,y=l=>{fetch("./park2.json").then(u=>u.json()).then(u=>{const f=[],h=new H;u.forEach(r=>{const[x,v]=n([r.longitude,r.latitude]);h.x=x,h.y=-v,h.z=.5,f.push(h.x,h.y,h.z);const E=vi();E.position.set(x,-v,.3),E.scale.setScalar(.2),d.add(E);const w=wi();w.position.set(x,-v,.3),w.scale.setScalar(.3),w.rotation.x=Math.PI/2,S.add(w),new st.Tween(w.position).to({z:.33},1e3).easing(st.Easing.Quadratic.InOut).yoyo(!0).repeat(1/0).delay(Math.random()*1e3).start()}),l.add(d),l.add(S),setInterval(()=>{i.add(c(u))},2e3)})},c=l=>{const u=Ei(),f=l[Math.floor(Math.random()*l.length)],[h,r]=n([f.longitude,f.latitude]),x=["入场","出场"],v=document.createElement("div");v.style.color="#fff",v.style.fontSize="12px",v.style.borderRadius="4px",v.style.padding="3px 6px",v.style.opacity=0,v.innerHTML=`
      <div class="info-box">
        <p>车场：${f.parkName}</p>
        <p>车辆：<span style="color: ${u.length===7?"blue":"green"}">${u}</span></p>
        <p>行为：${x[Math.floor(Math.random()*x.length)]}</p>
      </div>
    `;let E=new Se(v);return E.scale.set(.01,.01,.01),E.position.set(h,-r,.6),new st.Tween({opacity:0}).to({opacity:1},1e3).easing(st.Easing.Quadratic.Out).onUpdate(w=>{E.element.style.opacity=w.opacity}).onComplete(()=>{new st.Tween({opacity:1}).to({opacity:0},1e3).easing(st.Easing.Quadratic.Out).delay(3e3).onUpdate(w=>{E.element.style.opacity=w.opacity}).onComplete(()=>{var w=E.element.parentElement;w&&w.removeChild(E.element),i.remove(E),E=null}).start()}).start(),E},s=l=>{l.rotation.x=-Math.PI/2;const f=new Cn().setFromObject(l).getCenter(new H),h=[0,0];l.position.x=l.position.x-f.x-h[0],l.position.z=l.position.z-f.z-h[1]};return(l,u)=>(bn(),An("div",Si))}};export{Ti as default};
